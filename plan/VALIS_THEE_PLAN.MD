# ðŸ§  VALIS Master Plan

This document outlines the high-level architecture, strategic vision, and upcoming sprints for the VALIS universal AI engine.

---

## ðŸŽ¯ Vision

> VALIS is a universal AI ego engine designed to scale from local apps to global access. It supports complex identity, memory, and personality systems across any model, provider, or interface â€” with full endpoint delivery, diagnostics, and dashboard control.

---

## ðŸ“Š Architecture Overview (See Mermaid Diagrams in `/plan`)

* `valis_overview.mmd` â€” Global request flow from UI â†’ engine â†’ model
* `valis_memory_stack.mmd` â€” Five-layer memory abstraction
* `valis_provider_flow.mmd` â€” Cascade and provider plug-in system
* `valis_future_cloud.mmd` â€” AWS-style scaling vision

---

## ðŸªœ Strategic Milestones

| Stage | Focus                    | Outcome                             |
| ----- | ------------------------ | ----------------------------------- |
| âœ… 1   | Memory System            | 5-layer unified memory with tagging |
| ðŸ”„ 2  | Provider Interface       | Provider-agnostic memory injection  |
| â­ï¸ 3  | Dashboard                | Dev + diagnostic web interface      |
| â³ 4   | Persistence Layer        | Redis/Postgres integration          |
| â³ 5   | API Gateway              | Secure request routing at scale     |
| â³ 6   | Deployment               | Docker, ECS/Kubernetes pipeline     |
| â³ 7   | Load Testing             | Simulate thousands of chats         |
| â³ 8   | SDKs / Endpoint Delivery | VALIS beams to any app              |

---

## ðŸ§  Sprint 7: Prompt Bridge for Providers

**Goal**: Ensure all providers (starting with Claude MCP) receive full memory + persona stack as prompt.

### âœ… Tasks

* Build `PromptComposer` that formats memory stack for Claude
* Create Claude-specific template for roleplay prompt
* Integrate `PromptComposer` into MCP persistent bridge
* Add toggle to test prompt via CLI (`test_prompt_render.py`)

### âœ… Acceptance

* MCP returns characterful, memory-aware response
* Prompt debug tool confirms all memory layers visible in prompt

---

## ðŸ–¥ï¸ Sprint 8: Dashboard & Diagnostics (v1)

**Goal**: Create a web-based interface for dev inspection, persona selection, and direct chat.

### âœ… Tasks

* Build FastAPI backend (if not already present)
* Create `/dashboard` endpoint w/ auth + static frontend
* UI components:

  * Persona selector
  * Chat window (streaming or reload-based)
  * Memory viewer panel (layers 1â€“5)
* Hook chat backend to `VALISEngine`

### âœ… Acceptance

* Chat works through dashboard
* Memory layers shown live
* Devs can inspect persona state + log

---

## ðŸ’¾ Sprint 9: Persistence Layer Abstraction

**Goal**: Wire memory to scalable backends â€” but keep file fallback.

### âœ… Tasks

* Design `StorageAdapter` interface
* Add Redis adapter (for session + general mem)
* Add Postgres or Mongo adapter (for canon + client mem)
* Fallback to file-based JSON if not connected

### âœ… Acceptance

* Memory routing works w/ Redis/Postgres
* JSON fallback still functional
* Clear config for switching storage type

---

## ðŸ“Œ Notes for Scaling

* The provider system must stay modular (OpenAI, Claude, Ollama, etc.)
* Memory must be portable, independent, and injectable
* The API layer must be rate-limited, stateless, horizontally scalable
* Redis should hold volatile layers; DB holds persistent identity
* Personas should eventually be user-editable with audit tracking
* Deployment target: Docker, ECS, or Kubernetes with healthcheck probes

---

> This plan is the living blueprint of VALIS. Update it as components evolve.
